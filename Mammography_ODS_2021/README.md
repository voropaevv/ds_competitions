# Предсказание класса BI-RADS по данным предсказаний нескольких нейронных сетей-детекторов

## Ссылка

[Ссылка](https://nbviewer.jupyter.org/github/voropaevv/ds_competitions/blob/master/mammography_ODS_2021/Mammography_ODS_2021.ipynb) на nbviewer для просмотра ноутбука.

## Цель

Обучение модели, которая предсказывает, какую классификацию по шкале Bi-Rads врачи поставили тому или иному пациенту.

## Описание

Автоматическое присвоение верной категории помогает врачам тратить меньше времени на описание маммографического исследования и используется для сортировки списка пациентов по степени риска. Можно пробовать пытаться напрямую предсказать категорию Bi-Rads по снимку, но, как показывает практика, значительно лучше с этой задачей справляются классические модели, обученные на предсказаниях нейронок. К тому же, предсказания классических моделей намного проще интерпретировать - мы можем легко сказать, какие свойства снимка повлияли на оценку для данного конкретного пациента. 

Все данные сгенерированы на настоящих изображениях реальных пациентов.

В качестве сырых данных предсказания нескольких нейронных сетей-детекторов для маммограмм молочной железы разных пациентов. На вход в каждую нейронную сеть попадает два снимка каждой груди, снятых под разными углами (проекции CC и MLO) в одно и то же время. На выходе мы получаем ряд предсказаний, которые представлены в виде формата`.json`.

Целевая метрика складывается из двух компонентов: 

- **Взвешенный balanced accuracy (WBA)** - среднее взвешенное чувствительностей по каждому классу (веса классов - `1.0, 1.0, 1.5, 1.5, 1.5`). Этот компонент отвечает за корректные предсказания по классам, причём классы с подозрением на злокачественные изменения предсказывать верно важнее. ****

- **Macro Averaged Mean Absolute Error (MA-MAE) **- метрика для несбалансированной ординальной классификации в условиях дисбаланса классов. Если правильный Bi-Rads - 2, то лучше предсказать 1, чем 4, эта метрика это учитывает.

Итоговое значение метрики считается как `WBA - 0.25 * MA-MAE`.

## Используемые библиотеки

**imblearn**, **sklearn**,**pandas**,**numpy**,**plotly**,**tqdm**, **matplotlib**_

## Вывод

Была построена модель, которая дает значение метрики на [private score](https://ods.ai/competitions/horrors-of-med-data-soc2021/leaderboard/private) `0.0253764269` .